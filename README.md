# 工廠環境衛生點檢管理系統 v2.2.5

[![Version](https://img.shields.io/badge/version-2.2.5-green.svg)](https://github.com/yourusername/factory-inspection-system)
[![ISO 22000](https://img.shields.io/badge/ISO-22000:2018-blue.svg)](https://www.iso.org/iso-22000-food-safety-management.html)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## 📋 系統簡介

基於 Google Sheets 和 Apps Script 的智能環境衛生點檢管理系統，符合 **ISO 22000:2018 食品安全管理系統** 標準。

### 🎯 核心特色

- ✅ **ISO 22000 合規** - 符合食品安全管理系統標準
- ✅ **動態表單編號** - 可自訂表單編號（預設：P-4-001 版本 A1）
- ✅ **智能追蹤** - 待追蹤項目自動更新
- ✅ **即時告警** - 溫濕度超標自動通知
- ✅ **高效能** - 2-3 秒完成批次提交
- ✅ **多語系** - 中英雙語切換
- ✅ **響應式設計** - 支援手機/平板/電腦
- ✅ **完整註解** - 所有程式皆有標準化註解

---

## 📊 系統功能

### 1. 日常點檢記錄
- 11 個區域，105 個點檢項目
- 三種狀態：OK / NOK / 待追蹤
- 早班 / 晚班 / 其它時段
- 跨區域批次提交

### 2. 溫濕度監控
- 6 個溫濕度測點
- 自動判定超標
- Email 告警通知
- 告警抑制機制（1 小時）

### 3. 統計分析
- 自訂期間統計
- NOK 項目排名（前五名）
- 趨勢圖與圓餅圖
- 一鍵匯出 Excel

### 4. ISO 22000 整合
- **表單編號**：P-4-001 版本 A1（可在 System_Config 自訂）
- **標準依據**：ISO 22000:2018
- **文件管制**：符合 7.5 文件化資訊要求
- **HACCP 整合**：溫濕度監控為關鍵控制點

---

## 🚀 快速開始

### 安裝步驟

1. **建立 Google Sheets**
2. **匯入程式碼**（8 個 .gs + 2 個 .html）
3. **初始化系統**
   ```
   選單：🏭 點檢系統 > 🔧 初始化系統
   ```
4. **開始使用**
   ```
   選單：🏭 點檢系統 > 📝 開啟點檢表單
   ```

---

## ⚙️ 自訂表單編號

### 修改步驟

1. 開啟 `System_Config` 工作表
2. 找到「ISO表單編號」欄位
3. 修改為您要的編號，例如：
   ```
   P-4-001 版本 A1
   QC-FS-001-R1
   FSMS-2026-001 V1.0
   ```
4. 重新載入點檢表單或統計報表
5. 表單編號自動更新 ✅

### 範例

| 原始編號 | 自訂編號 | 適用情境 |
|---------|---------|---------|
| P-4-001 版本 A1 | P-4-002 版本 B1 | 版本更新 |
| P-4-001 版本 A1 | QC-FSMS-001 | 品管部門編號 |
| P-4-001 版本 A1 | 工廠-2026-001 | 含中文編號 |

---

## 📚 文件結構

### 後端程式 (.gs) - 8 個檔案
| 檔案 | 功能 | 版本 |
|------|------|------|
| Code.gs | 主程式與選單 | v2.2.5 |
| SheetInitializer.gs | 工作表初始化 | v2.2.5 |
| DataHandler.gs | 資料處理 | v2.2.5 |
| AlertSystem.gs | 告警系統 | v2.2.5 |
| InspectionItems.gs | 點檢項目 | v2.2.5 |
| Statistics.gs | 統計分析 | v2.2.5 |
| Triggers.gs | 觸發器 | v2.2.5 |
| I18n.gs | 多語系 | v2.2.5 |

### 前端介面 (.html) - 2 個檔案
| 檔案 | 功能 | 版本 |
|------|------|------|
| InspectionForm.html | 點檢輸入表單 | v2.2.5 |
| StatisticsView.html | 統計報表 | v2.2.5 |

**所有檔案特色**：
- ✅ 完整的檔案頭註解
- ✅ 標示版本 v2.2.5
- ✅ 說明功能與相依性
- ✅ 記錄更新歷程

---

## 🔧 系統設定

### System_Config 工作表

| 設定項目 | 預設值 | 說明 |
|---------|--------|------|
| 點檢時段 | 早,晚,其它 | 可自訂 |
| 預設點檢人員 | 張三,李四... | 用逗號分隔 |
| **ISO表單編號** | **P-4-001 版本 A1** | **可自訂** |
| **ISO標準** | **ISO 22000:2018** | 系統標準 |
| 系統版本 | v2.2.5 | 當前版本 |

### TempHumidity_Criteria 工作表

設定溫濕度監控標準：

| 測點 | 標準範圍 | 用途 |
|------|----------|------|
| 秤料室濕度 | 30-60 %RH | 防止物料受潮 |
| 物料室濕度 | 30-60 %RH | 物料儲存環境 |
| 半成品暫存區溫度 | 0-7 ℃ | 冷藏溫度控制 |
| 半成品冷凍區溫度 | -18~-10 ℃ | 冷凍溫度控制 |
| 原料庫溫度 | -20~-15 ℃ | 原料冷凍庫 |
| 成品庫溫度 | -20~-15 ℃ | 成品冷凍庫 |

---

## 📝 更新日誌

### v2.2.5 (2026-01-26)
- ✨ ISO 22000:2018 整合
- ✨ 動態表單編號（可自訂）
- ✨ 所有程式加入完整註解
- ✨ 表單編號預設改為 `P-4-001 版本 A1`

### v2.2.4 (2026-01-26)
- ⚡ 效能優化 80%（2-3 秒提交）
- 📧 完整告警系統
- 🛡️ 告警抑制機制

### v2.2.3 (2026-01-26)
- 🔧 UI 優化
- 🔧 資料路由修正

[查看完整更新日誌](UPDATE_NOTES_v2.2.5.md)

---

## 📄 相關文件

- [更新說明 v2.2.5](UPDATE_NOTES_v2.2.5.md) - 詳細更新內容
- [告警設定指南](ALERT_EMAIL_SETUP_GUIDE.md) - Email 告警設定
- [更新說明 v2.2.4](UPDATE_NOTES_v2.2.4.md) - 效能優化
- [緊急修正 v2.2.4.1](HOTFIX_v2.2.4.1.md) - Bug 修正

---

## 🎯 ISO 22000:2018 對應

### 文件管制

| 文件 | 編號 | ISO 章節 |
|------|------|---------|
| 點檢表單 | P-4-001 版本 A1 | 7.5 文件化資訊 |
| 統計報表 | P-4-001 版本 A1 | 8.5.2 監測與測量 |
| 溫濕度記錄 | 自動產生 | 8.5.2 監測與測量 |
| 告警記錄 | 自動產生 | 8.5.3 分析與評價 |

### HACCP 原則整合

| HACCP 原則 | 系統功能 |
|-----------|---------|
| 危害分析 | 溫濕度監控點 |
| 關鍵控制點 | 6 個溫濕度測點 |
| 設定關鍵限值 | 上下限標準 |
| 監測程序 | 每日點檢記錄 |
| 矯正措施 | 告警通知 + 備註 |
| 驗證程序 | 統計報表分析 |
| 文件化 | 自動記錄保存 |

---

## 📞 支援

### 問題回報
- [GitHub Issues](https://github.com/yourusername/factory-inspection-system/issues)
- [故障排除](ALERT_EMAIL_SETUP_GUIDE.md#故障排除)

### 技術支援
- 查看更新說明文件
- 檢查 Apps Script 執行記錄

---

## 📄 授權

MIT License

---

**系統版本**：v2.2.5  
**ISO 標準**：ISO 22000:2018  
**表單編號**：P-4-001 版本 A1（可自訂）  
**最後更新**：2026-01-26

---

⭐ **所有程式檔案已加入完整註解，方便維護與開發！**
