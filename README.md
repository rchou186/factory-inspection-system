# 工廠環境衛生點檢管理系統

## 系統簡介

基於 Google Sheets 和 Apps Script 的智能環境衛生點檢管理系統，實現工廠各區域設備及環境衛生的日常點檢記錄、追蹤與統計分析。

## 核心功能

- ✅ **日常點檢記錄**：11 個區域，105 個點檢項目
- ✅ **溫濕度監控**：6 個測點，自動告警
- ✅ **智能追蹤**：待追蹤項目自動更新
- ✅ **統計分析**：自訂期間報表、趨勢圖、圓餅圖
- ✅ **高效能**：批次處理，2-3 秒完成提交
- ✅ **多語系**：中英雙語切換
- ✅ **響應式設計**：支援手機、平板、電腦

## 系統特色

### 1. 點檢記錄
- 三種狀態：OK / NOK / 待追蹤
- 早班 / 晚班 / 其它時段
- 跨區域統一提交
- 區域完成度視覺標示

### 2. 溫濕度監控
- 自動判定超標
- Email 告警通知
- 告警抑制機制（1 小時）
- 告警歷史記錄

### 3. 統計報表
- NOK 項目排名（前五名）
- 自訂期間統計
- 趨勢圖與圓餅圖
- 一鍵匯出 Excel

## 快速開始

### 前置需求
- Google 帳號
- Google Sheets 存取權限

### 安裝步驟

1. **建立 Google Sheets**
2. **匯入程式碼**
   - 開啟 Apps Script 編輯器
   - 複製所有 .gs 和 .html 檔案
3. **初始化系統**
   - 選單：🏭 點檢系統 > 🔧 初始化系統
4. **開始使用**
   - 選單：🏭 點檢系統 > 📝 開始點檢

## 檔案結構

### 後端程式 (.gs 檔案)
- Config.gs - 系統常數
- Code.gs - 主程式
- SheetInitializer.gs - 工作表初始化
- InspectionItems.gs - 點檢項目
- DataHandler.gs - 資料處理
- AlertSystem.gs - 告警系統
- Statistics.gs - 統計分析
- Triggers.gs - 觸發器
- I18n.gs - 多語系

### 前端介面 (.html 檔案)
- InspectionForm.html - 點檢表單
- StatisticsView.html - 統計報表

## 溫濕度監控

### 測點設定
在 `TempHumidity_Criteria` 工作表設定：
```
測點名稱：秤料室濕度
下限值：30
上限值：60
是否啟用告警：TRUE
告警收件人：manager@company.com
```

### 告警機制
- 超標自動發送 Email
- 1 小時內同一測點只發送 1 次
- 告警歷史自動記錄

## 系統設定

在 `System_Config` 工作表可設定：
- 點檢時段
- 預設點檢人員
- ISO 表單編號
- 系統版本

## 版本資訊

**當前版本**：v2.2.4  
**更新日期**：2026-01-26  
**表單編號**：QP-7.5-001 (ISO 9001)

### 主要更新 (v2.2.4)
- ⚡ 提交效能優化 80%（15秒 → 2-3秒）
- 📧 完整告警系統
- 🛡️ 告警抑制機制
- 📊 告警歷史記錄

## 文件

- [告警設定指南](ALERT_EMAIL_SETUP_GUIDE.md)
- [更新說明 v2.2.4](UPDATE_NOTES_v2.2.4.md)
- [更新說明 v2.2.3](UPDATE_NOTES_v2.2.3.md)
- [緊急修正 v2.2.4.1](HOTFIX_v2.2.4.1.md)

## 授權

MIT License

## 支援

如有問題請參考：
- [故障排除](ALERT_EMAIL_SETUP_GUIDE.md#故障排除)
- GitHub Issues

---

**系統版本**：v2.2.4  
**ISO 標準**：ISO 9001  
**最後更新**：2026-01-26
