# 快速部署指南

## 📦 檔案清單

本專案包含以下檔案：

### Google Apps Script 檔案 (.gs)
1. `Code.gs` - 主程式（系統入口）
2. `SheetInitializer.gs` - 工作表初始化
3. `InspectionItems.gs` - 點檢項目資料（105項+6溫濕度點）
4. `DataHandler.gs` - 資料處理
5. `Statistics.gs` - 統計分析
6. `AlertSystem.gs` - 告警系統
7. `Triggers.gs` - 觸發器管理
8. `I18n.gs` - 多語系支援

### HTML 檔案
1. `InspectionForm.html` - 點檢表單介面
2. `StatisticsView.html` - 統計報表介面

### 文件檔案
1. `README.md` - 完整系統說明
2. `QUICK_DEPLOY.md` - 本部署指南

## 🚀 5分鐘快速部署

### 步驟 1: 建立 Google 試算表 (30秒)

1. 前往 https://sheets.google.com
2. 點選「空白」建立新試算表
3. 將試算表命名為「工廠環境衛生點檢管理系統」

### 步驟 2: 開啟 Apps Script 編輯器 (15秒)

1. 在試算表中，點選上方選單：**擴充功能** > **Apps Script**
2. 會開啟新分頁，顯示 Apps Script 編輯器

### 步驟 3: 貼上程式碼 (3分鐘)

#### 3.1 主程式
- 將 `Code.gs` 的內容全選並複製
- 貼到 Apps Script 編輯器預設的 `Code.gs` 檔案中（覆蓋原有內容）

#### 3.2 建立其他 .gs 檔案
對以下每個檔案重複此步驟：

1. 點選左側的「+」號（檔案旁邊）
2. 選擇「指令碼」
3. 輸入檔案名稱（不含 .gs）
4. 複製並貼上對應的檔案內容
5. 按 Ctrl+S 儲存

需要建立的檔案：
- `SheetInitializer`
- `InspectionItems`
- `DataHandler`
- `Statistics`
- `AlertSystem`
- `Triggers`
- `I18n`

#### 3.3 建立 HTML 檔案
對以下每個檔案重複此步驟：

1. 點選左側的「+」號
2. 選擇「HTML」
3. 輸入檔案名稱
4. 複製並貼上對應的檔案內容
5. 按 Ctrl+S 儲存

需要建立的檔案：
- `InspectionForm`
- `StatisticsView`

### 步驟 4: 部署為 Web App (1分鐘)

1. 點選右上角的「部署」按鈕
2. 選擇「新增部署」
3. 點選「選取類型」旁的齒輪圖示
4. 選擇「網頁應用程式」
5. 設定：
   - **新說明**：v2.2
   - **執行身分**：我
   - **具有存取權的使用者**：組織內的任何人（或依需求選擇）
6. 點選「部署」
7. **重要**：複製「網頁應用程式」網址並儲存（稍後使用）

### 步驟 5: 授權與初始化 (1分鐘)

1. 回到試算表分頁
2. 重新整理頁面（F5）
3. 會看到新選單「🏭 點檢系統」
4. 點選「🔄 初始化系統」
5. 首次執行會要求授權：
   - 點選「查看權限」
   - 選擇您的 Google 帳號
   - 點選「進階」
   - 點選「前往『專案名稱』（不安全）」
   - 點選「允許」
6. 再次點選「🔄 初始化系統」
7. 點選「是」確認
8. 等待約30秒，直到出現「✅ 系統初始化完成！」

### 步驟 6: 測試系統 (30秒)

1. 點選「📝 開啟點檢表單」
2. 應該會開啟新分頁顯示點檢表單
3. 測試填寫一些資料
4. 回到試算表，檢查「Inspection_Records」工作表是否有資料

## ✅ 完成！

系統已成功部署，您現在可以：

- 使用點檢表單進行日常點檢
- 查看統計報表
- 設定溫濕度告警
- 自訂統計期間

## 📱 使用系統

### 方式一：從試算表選單
- 點檢：「🏭 點檢系統」>「📝 開啟點檢表單」
- 報表：「🏭 點檢系統」>「📊 查看統計報表」

### 方式二：直接開啟網址
使用步驟4複製的網頁應用程式網址：
- 點檢表單：`網址`
- 統計報表：`網址?page=statistics`

## 🔧 進階設定

### 設定溫濕度告警

1. 開啟「TempHumidity_Criteria」工作表
2. 在「告警收件人」欄位填入 Email
3. 多個收件人用逗號分隔：`user1@company.com,user2@company.com`

### 自訂點檢人員清單

在「System_Config」工作表中：
- 找到「預設點檢人員」欄位
- 填入人員名單（逗號分隔）

### 備份資料

定期備份：
1. 點選「🏭 點檢系統」>「📤 匯出資料」
2. 系統會建立完整備份

## 🐛 疑難排解

### 問題1: 選單沒有出現

**解決方式**：
1. 重新整理頁面（F5）
2. 清除瀏覽器快取
3. 關閉試算表後重新開啟

### 問題2: 初始化失敗

**解決方式**：
1. 檢查是否已授權
2. 確認所有 .gs 和 .html 檔案都已建立
3. 查看 Apps Script 執行記錄（檢視 > 執行記錄）

### 問題3: 無法開啟表單

**解決方式**：
1. 確認已完成部署（步驟4）
2. 檢查部署設定中的「具有存取權的使用者」
3. 重新部署（建立新版本）

### 問題4: 資料沒有儲存

**解決方式**：
1. 檢查網路連線
2. 確認試算表有寫入權限
3. 查看瀏覽器主控台是否有錯誤訊息（F12）

## 📞 取得協助

1. 詳細說明：查看 `README.md`
2. 程式碼問題：查看 Apps Script 執行記錄
3. 功能說明：參考規劃書文件

## 🎯 下一步

系統已準備就緒，建議：

1. ✅ 設定溫濕度告警收件人
2. ✅ 測試點檢流程
3. ✅ 培訓使用者
4. ✅ 建立定期備份計畫
5. ✅ 將網址加入書籤或建立捷徑

---

**祝您使用愉快！**

如有任何問題，請參考 README.md 或聯絡系統管理員。
